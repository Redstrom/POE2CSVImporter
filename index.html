<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PoE Guild Loot Splitter</title>
  <!-- ✅ Lien correct vers la feuille de style -->
  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-light">
  <header class="topbar container">
    <h1 data-i18n="app.title">PoE Guild Loot Splitter — Répartition des currencies par coffre</h1>
    <div class="controls">
      <label for="langSelect" data-i18n="ui.language">Langue :</label>
      <select id="langSelect" aria-label="Language">
        <option value="fr">FR</option>
        <option value="en">EN</option>
      </select>
      <label class="theme-toggle">
        <input id="themeToggle" type="checkbox" />
        <span data-i18n="ui.theme">Mode sombre</span>
      </label>
      <button id="toggleImportBtn" class="btn" type="button" data-i18n="ui.toggleImport">Afficher la zone d’import</button>
    </div>
  </header>

  <main class="container">
    <!-- Import (collapsible) -->
    <section id="importSection" class="file-upload-section">
      <h2 data-i18n="section.import.title">Import</h2>

      <div class="upload-row">
        <input id="csvFileInput" type="file" accept=".csv" />
        <div id="dropZone" class="drop-zone" aria-label="Drag & drop area">
          <span data-i18n="drop.hint">Glissez-déposez votre CSV ici, ou cliquez pour choisir un fichier</span>
        </div>
      </div>
      <p class="muted" data-i18n="import.hint">Après import, cette zone se réduit automatiquement pour laisser la place aux tableaux.</p>
    </section>

    <!-- Prévisualisation (+ filtres, même container) -->
    <section id="preview" class="preview-section">
	    <label class="inline" style="gap:6px">
          <input id="inventoryMode" type="checkbox" />
          <span data-i18n="input.inventoryMode.label">
            Afficher l’inventaire au lieu de l'historique du coffre
          </span>
        </label>
      <div class="preview-header">
        <!-- ✅ Titre dynamique (Inventaire / Logs) mis à jour côté JS -->
        <h2 id="previewTitle" data-i18n="section.preview.title.inventory">Inventaire</h2>

        <div class="filters-inline">
          <label for="stashFilter" data-i18n="input.stash">Coffre :</label>
          <select id="stashFilter">
            <option value="" data-i18n="select.any">Tous</option>
          </select>

          <label for="accountFilter" data-i18n="input.account">Compte :</label>
          <select id="accountFilter">
            <option value="" data-i18n="select.any">Tous</option>
          </select>

          <label for="actionFilter" data-i18n="input.action">Action :</label>
          <select id="actionFilter">
            <option value="" data-i18n="select.any">Toutes</option>
          </select>

          <label for="itemFilterInput" data-i18n="input.item">Item :</label>
          <input id="itemFilterInput" type="text" placeholder="" />
        </div>
      </div>

      <div class="pagination-bar">
        <label for="pageSizeSelect" data-i18n="pagination.pageSize">Lignes / page :</label>
        <select id="pageSizeSelect">
          <option value="10">10</option>
          <option value="25" selected>25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
        <button id="prevPageBtn" class="btn" disabled>◀</button>
        <span id="pageInfo" class="muted">1 / 1</span>
        <button id="nextPageBtn" class="btn" disabled>▶</button>
      </div>

      <table id="previewTable" class="sortable">
        <thead>
          <tr>
            <th data-sort-key="Date" aria-sort="none"><span data-i18n="th.date">Date</span><span class="sort-indicator"></span></th>
            <th data-sort-key="Account" aria-sort="none"><span data-i18n="th.account">Compte</span><span class="sort-indicator"></span></th>
            <th data-sort-key="Action" aria-sort="none"><span data-i18n="th.action">Action</span><span class="sort-indicator"></span></th>
            <th data-sort-key="Stash" aria-sort="none"><span data-i18n="th.stash">Coffre</span><span class="sort-indicator"></span></th>
            <th data-sort-key="Qty" aria-sort="none"><span data-i18n="th.qty">Quantité</span><span class="sort-indicator"></span></th>
            <th data-sort-key="ItemName" aria-sort="none"><span data-i18n="th.item">Item</span><span class="sort-indicator"></span></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Répartition des currencies (+ texte) -->
    <section id="split" class="split-section">
      <h2 data-i18n="section.split.title">Répartition des currencies</h2>
      <div class="split-controls">
        <label for="playerCount" data-i18n="input.playerCount">Nombre de joueurs :</label>
        <input id="playerCount" type="number" min="1" max="6" value="1" />
        <label for="textModeSelect" data-i18n="text.mode.label">Format du texte :</label>
        <select id="textModeSelect">
          <option value="perPlayer" selected data-i18n="text.mode.perPlayer">Par joueur</option>
          <option value="total" data-i18n="text.mode.total">Total + reste</option>
        </select>
        <button id="copySplitBtn" class="btn" data-i18n="text.copy">Copier la liste</button>
      </div>

      <table id="currencySplitTable" class="sortable">
        <thead>
          <tr>
            <th data-sort-key="item" aria-sort="descending"><span data-i18n="th.currency">Monétaire</span><span class="sort-indicator"></span></th>
            <th data-sort-key="total" aria-sort="descending"><span data-i18n="th.total">Total</span><span class="sort-indicator"></span></th>
            <th data-sort-key="perPlayer" aria-sort="none"><span data-i18n="th.perPlayer">Par joueur</span><span class="sort-indicator"></span></th>
            <th data-sort-key="remainder" aria-sort="none"><span data-i18n="th.remainder">Reste</span><span class="sort-indicator"></span></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <pre id="splitTextPreview" class="text-preview" aria-live="polite"></pre>
    </section>
  </main>

  <!-- ✅ Script correctement lié -->
  <script src="Poe2CSVImporter.js" defer></script>
</body>
</html>
